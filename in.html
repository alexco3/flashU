<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Premium Wallet System</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
/* --- styles remain same --- */
body{margin:0;font-family:'Inter',sans-serif;background:#f5f7fb;color:#333}
header{background:linear-gradient(90deg,#673ab7,#512da8);color:#fff;padding:1rem;text-align:center;border-radius:0 0 20px 20px}
.container{max-width:960px;margin:1rem auto;padding:1rem}
.card{background:#fff;border-radius:20px;padding:1.2rem;margin:1rem 0;box-shadow:0 6px 15px rgba(0,0,0,.1)}
input,button{width:100%;padding:.8rem;margin:.4rem 0;border-radius:10px;border:1px solid #ccc;font-size:1rem}
button{border:none;color:#fff;font-weight:600;cursor:pointer;transition:.2s}
button:hover{opacity:.9}
nav{display:flex;flex-wrap:wrap;gap:.4rem;margin:.6rem 0}
nav button{flex:1;padding:.6rem;font-size:.9rem;border-radius:10px;display:flex;align-items:center;justify-content:center;gap:.4rem}
nav button.active{box-shadow:0 4px 12px rgba(0,0,0,.2);transform:scale(1.05)}
.balance{background:linear-gradient(135deg,#1e3c72,#2a5298);color:#fff;padding:1rem;border-radius:16px;margin:1rem 0;box-shadow:0 8px 16px rgba(0,0,0,.2)}
.amt{font-size:1.6rem;font-weight:bold}
.tx{padding:.6rem;margin:.3rem 0;border-radius:8px;background:#fff;box-shadow:0 1px 3px rgba(0,0,0,.1)}
.tx.deposit{border-left:5px solid #4caf50}
.tx.withdraw{border-left:5px solid #f44336}
.tx.credit{border-left:5px solid #3f51b5}
.notif{padding:.6rem;background:#e0f7fa;margin:.3rem 0;border-radius:8px}
.logout{background:linear-gradient(45deg,#ff5722,#d84315)}
#toast{position:fixed;top:20px;right:20px;z-index:9999}
.toast{background:#333;color:#fff;padding:10px 20px;margin-top:10px;border-radius:8px;opacity:0;transform:translateX(100%);transition:all .4s}
.toast.show{opacity:1;transform:translateX(0)}
.toast.success{background:#4caf50}
.toast.error{background:#f44336}
.admin-only{background:#e3f2fd;border-left:5px solid #1976d2;margin:.6rem 0;padding:.6rem;border-radius:10px}
</style>
</head>
<body>

<header>
  <h1>ğŸŒ Premium Wallet System</h1>
  <p>User Panel & Admin Control</p>
</header>

<div class="container">

  <!-- Authentication -->
  <div id="auth" class="card">
    <h2>Sign In / Sign Up</h2>
    <input id="email" placeholder="Email">
    <div style="position:relative;">
      <input type="password" id="password" placeholder="Password">
      <button type="button" id="togglePass" style="position:absolute;right:10px;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;">ğŸ‘ï¸</button>
    </div>
    <button id="signIn" style="background:#4caf50">Sign In</button>
    <button id="signUp" style="background:#673ab7">Create Account</button>
  </div>

  <!-- User Wallet -->
  <div id="wallet" class="card" style="display:none">
    <h2>Hello, <span id="userEmail"></span></h2>
    <div class="balance"><div class="amt" id="balanceAmt">$0</div></div>
    <nav>
      <button data-tab="dashboard">ğŸ“Š Dashboard</button>
      <button data-tab="deposit">ğŸ’° Deposit</button>
      <button data-tab="withdraw">ğŸ¦ Withdraw</button>
      <button data-tab="credit">ğŸ“¥ Credit</button>
      <button data-tab="tx">ğŸ“‘ Transactions</button>
      <button data-tab="notif">ğŸ”” Notifications</button>
      <button data-tab="profile">ğŸ™ Profile</button>
      <button data-tab="guides">ğŸ“– Guides</button>
      <button data-tab="admin">âš™ï¸ Admin Panel</button>
    </nav>
    <div id="tabContent"></div>
    <button class="logout" id="logout">Sign Out</button>
  </div>
</div>

<div id="toast"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-auth.js";

// âœ… Your Firebase project settings integrated
const app = initializeApp({
  apiKey:"AIzaSyDtzDCtvM1R71db5qHcwpjVWOgPJ2PnCL0",
  authDomain:"my-globalwallet.firebaseapp.com",
  projectId:"my-globalwallet"
});
const auth = getAuth(app);

// --- rest of the logic (same as before) ---
let db = JSON.parse(localStorage.getItem("usersDB")||"{}");
let currentUser = null;
const authBox=document.getElementById("auth"),
      wallet=document.getElementById("wallet"),
      userEmail=document.getElementById("userEmail"),
      balanceAmt=document.getElementById("balanceAmt"),
      tabContent=document.getElementById("tabContent"),
      emailInput=document.getElementById("email"),
      passwordInput=document.getElementById("password"),
      signUpBtn=document.getElementById("signUp"),
      signInBtn=document.getElementById("signIn"),
      logoutBtn=document.getElementById("logout"),
      togglePass=document.getElementById("togglePass");

function toast(msg,type=""){const t=document.createElement("div");t.className=`toast ${type}`;t.textContent=msg;document.getElementById("toast").appendChild(t);setTimeout(()=>t.classList.add("show"),100);setTimeout(()=>t.remove(),4000);}
togglePass.addEventListener("click",(e)=>{e.preventDefault();passwordInput.type=passwordInput.type==="password"?"text":"password";});

// --- signup ---
signUpBtn.addEventListener("click",()=>{
  const email=emailInput.value.trim(), pass=passwordInput.value.trim();
  if(pass.length<6){toast("Password must be at least 6 characters","error");return;}
  createUserWithEmailAndPassword(auth,email,pass).then(()=>{
    db[email]={balance:100000,tx:[`+ $100000 Signup Bonus`],notif:["Welcome bonus added!"]};
    localStorage.setItem("usersDB",JSON.stringify(db));
    toast("ğŸ‰ Account created!","success");
  }).catch(e=>toast(e.message,"error"));
});

// --- signin ---
signInBtn.addEventListener("click",()=>{
  const email=emailInput.value.trim(), pass=passwordInput.value.trim();
  signInWithEmailAndPassword(auth,email,pass).then(()=>{
    currentUser=email;
    if(!db[email]) db[email]={balance:100000,tx:[],notif:[]};
    localStorage.setItem("usersDB",JSON.stringify(db));
    loadDashboard();
    authBox.style.display="none";wallet.style.display="block";userEmail.textContent=email;
  }).catch(e=>toast(e.message,"error"));
});

// --- signout ---
logoutBtn.addEventListener("click",()=>{signOut(auth).then(()=>{authBox.style.display="block";wallet.style.display="none";currentUser=null;});});
onAuthStateChanged(auth,u=>{if(u){currentUser=u.email;authBox.style.display="none";wallet.style.display="block";userEmail.textContent=u.email;loadDashboard();}else{authBox.style.display="block";wallet.style.display="none";}});

// --- tabs, admin panel, transactions (same as previous version) ---
const tabButtons=document.querySelectorAll("nav button");
tabButtons.forEach(btn=>btn.addEventListener("click",()=>activateTab(btn.dataset.tab)));
function activateTab(tab){tabButtons.forEach(b=>b.classList.remove("active"));document.querySelector(`nav button[data-tab="${tab}"]`).classList.add("active");renderTab(tab);}
function loadDashboard(){updateBalance();activateTab("dashboard");}
function updateBalance(){balanceAmt.textContent=`$${db[currentUser].balance.toLocaleString()}`;}

function renderTab(t){
  if(t==="dashboard"){tabContent.innerHTML=`<h3>Dashboard</h3><p>Your balance: $${db[currentUser].balance}</p>`;}
  if(t==="deposit"){tabContent.innerHTML=`<h3>Deposit</h3><p>Send crypto to admin wallet.</p>`;}
  if(t==="withdraw"){tabContent.innerHTML=`<h3>Withdraw</h3><input id="amt" placeholder="Amount"><button onclick="sendWithdraw()">Request</button>`;}
  if(t==="credit"){tabContent.innerHTML=`<h3>Request Credit</h3><input id="creditAmt" placeholder="Amount"><button onclick="reqCredit()">Request</button>`;}
  if(t==="tx"){tabContent.innerHTML=`<h3>Transactions</h3>${db[currentUser].tx.map(x=>`<div class="tx">${x}</div>`).join("")}`;}
  if(t==="notif"){tabContent.innerHTML=`<h3>Notifications</h3>${db[currentUser].notif.map(n=>`<div class="notif">${n}</div>`).join("")}`;}
  if(t==="profile"){tabContent.innerHTML=`<h3>Profile</h3><p>Email: ${currentUser}</p>`;}
  if(t==="guides"){tabContent.innerHTML=`<h3>Guides</h3><p>Use deposit/withdraw/credit tabs as needed.</p>`;}
  if(t==="admin"){renderAdmin();}
}
window.sendWithdraw=()=>{let amt=parseFloat(document.getElementById("amt").value||0);if(amt<=0){toast("Enter valid amount","error");return;}db[currentUser].tx.push(`- $${amt} Withdraw Request`);db[currentUser].notif.push(`Withdraw request of $${amt} sent to Admin.`);localStorage.setItem("usersDB",JSON.stringify(db));toast("Withdraw request sent","success");activateTab("tx");}
window.reqCredit=()=>{let amt=parseFloat(document.getElementById("creditAmt").value||0);if(amt<=0){toast("Invalid amount","error");return;}db[currentUser].tx.push(`+ $${amt} Credit Requested`);db[currentUser].notif.push(`Credit of $${amt} requested.`);localStorage.setItem("usersDB",JSON.stringify(db));toast("Credit requested","success");activateTab("tx");}

// --- admin panel ---
function renderAdmin(){
  if(currentUser!=="admin@site.com"){tabContent.innerHTML="<p>ğŸš« Only admin can access this panel.</p>";return;}
  let html="<h3>Admin Panel</h3>";
  Object.keys(db).forEach(u=>{
    html+=`<div class="admin-only"><b>${u}</b> | Balance: $${db[u].balance}<br>
    <button onclick="resetBalance('${u}')">Reset Balance</button>
    <button onclick="notifyUser('${u}')">Send Notification</button></div>`;
  });
  tabContent.innerHTML=html;
}
window.resetBalance=(u)=>{db[u].balance=100000;db[u].notif.push("Balance reset by admin");localStorage.setItem("usersDB",JSON.stringify(db));toast("Balance reset","success");renderAdmin();}
window.notifyUser=(u)=>{let msg=prompt("Enter notification message:");if(!msg)return;db[u].notif.push("Admin: "+msg);localStorage.setItem("usersDB",JSON.stringify(db));toast("Notification sent","success");renderAdmin();}
</script>
</body>
</html>
